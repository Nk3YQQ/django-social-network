{% extends 'network/base.html' %}

{% block content %}
<div class="container p-0">
    <div class="card">
        <div class="row g-0">
            {% include 'includes/inc_network_chat_list.html' %}
            <div class="col-12 col-lg-7 col-xl-9">
                <div class="py-2 px-4 border-bottom d-none d-lg-block">
                    <div class="d-flex align-items-center py-1">
                        <div class="position-relative">
                           <a href="{% url 'users:user_detail' pk=user_pk %}"><img src="https://bootdey.com/img/Content/avatar/avatar3.png"
                                 class="rounded-circle mr-1" alt="Sharon Lessman" width="40" height="40"></a>
                        </div>
                        <div class="flex-grow-1 ms-2">
                            {% if object.user_1 == request.user %}
                            <strong>{{ object.user_2 }}</strong>
                            {% else %}
                            <strong>{{ object.user_1 }}</strong>
                            {% endif %}
                            <div class="text-muted small"><em>Typing...</em></div>
                        </div>
                    </div>
                </div>

                <div class="position-relative">
                    <div class="chat-messages p-4">
                        {% for message in messages %}
                        {% if message.sender == request.user %}
                        <div class="chat-message-right mb-4">
                            <div>
                                <a href="{% url 'users:user_detail' pk=request.user.pk %}"><img src="https://bootdey.com/img/Content/avatar/avatar1.png"
                                                                                        class="rounded-circle mr-1" alt="Chris Wood" width="40" height="40"></a>
                                <div class="text-muted small text-nowrap mt-2">{{ message.created_at|date:"H:i" }}</div>
                            </div>
                            <div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3">
                                <div class="font-weight-bold mb-1">You</div>
                                {{ message.content }}
                            </div>
                        </div>
                        {% else %}
                        <div class="chat-message-left pb-4">
                            <div>
                                <a href="{% url 'users:user_detail' pk=user_pk %}"><img src="https://bootdey.com/img/Content/avatar/avatar3.png"
                                                                                        class="rounded-circle mr-1" alt="Sharon Lessman" width="40" height="40"></a>
                                <div class="text-muted small text-nowrap mt-2">{{ message.created_at|date:"H:i" }}</div>
                            </div>
                            <div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3">
                                {% if object.user_1 == request.user %}
                                <div class="font-weight-bold mb-1">{{ object.user_2 }}</div>
                                {% else %}
                                <div class="font-weight-bold mb-1">{{ object.user_1 }}</div>
                                {% endif %}
                                {{ message.content }}
                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>

                <form class="flex-grow-0 py-3 px-4 border-top" method="post">
                    {% csrf_token %}
                    <div class="input-group">
                        <input type="text" class="form-control" name="content" placeholder="Type your message">
                        <button class="btn btn-primary">Send</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}